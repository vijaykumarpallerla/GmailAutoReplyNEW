{% extends 'base.html' %}
{% block content %}
<div class="sidebar">
    <div class="sidebar-title">Automation</div>
    <ul>
        <li class="active"><span>⚡</span> Rules <button id="addRuleBtn">+</button></li>
    </ul>
</div>
<div class="main-content">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <h2 style="margin:0;">Rules</h2>
    </div>
    <!-- Gmail Status Card Removed as per Single-Step Login Requirement -->

    <!-- Stats Card -->
    <div class="card"
        style="margin-bottom:16px;padding:12px;border:1px solid #ddd;border-radius:8px; display: flex; gap: 20px;">
        <div>
            <strong>Sent Today:</strong> {{ today_count }}
        </div>
        <div>
            <strong>Total Sent:</strong> {{ total_count }}
        </div>
    </div>
    {% if gmail_auth_issue %}
    <div style="margin-top:12px;padding:12px;background:#3e2b00;color:#fff;border-radius:8px;display:flex;align-items:center;gap:12px;">
        <div style="font-weight:700;">Gmail authentication required</div>
        <div style="flex:1;opacity:0.95;">One of your accounts needs re-login — click to reconnect.</div>
        <a href="{% url 'gmail_auth' %}" style="background:#ffd780;padding:8px 12px;border-radius:6px;color:#222;font-weight:600;text-decoration:none;">Reconnect Gmail</a>
    </div>
    {% endif %}
    <div id="rulesTableContainer"></div>
    <div id="ruleModal" class="modal" style="display:none;"></div>
</div>
<script src="/static/rules_dashboard.js"></script>

<script>
    // Additional dashboard logic if needed
</script>
{% endblock %}